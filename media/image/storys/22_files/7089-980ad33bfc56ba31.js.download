(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7089],{47792:function(e,t,n){"use strict";n.d(t,{m:function(){return a}});var o=n(45227),r=n(8398),a=(0,n(1324).q)({url:function(e){var t=e.postId;return"/magnet/posts/".concat(t,"/like/")},inputTransformer:r.d,transformer:function(e){var t=e.data||{};return{isLiked:t.liked,likesCount:t.likes_count}},type:o.XN.POST})},51383:function(e,t,n){"use strict";n.d(t,{P:function(){return l}});var o=n(52322),r=n(26442),a=n(66781),s=n(82650),i=n(27314),c=n(87049),u=n(6013),d=n(72677);function l(e){var t=e.children,n=(0,s.z)().emit,l=(0,i.e)().redirect,m=(0,c.v)(u.p.socialData).isSocialActivated,p=(0,c.v)(u.p.isLoggedIn);return(0,o.jsx)("div",{onClick:function(){if(!p){l({url:r.SW,withBackUrl:!0});return}m||n(a.bl)},children:(0,o.jsx)("div",{className:(0,d.d)({"pointer-events-none":!m}),children:t})})}},23248:function(e,t,n){"use strict";n.d(t,{D:function(){return D}});var o=n(70865),r=n(96670),a=n(66383),s=n(50930),i=n(52322),c=n(2784),u=n(5632),d=n(57033),l=n(72610),m=n(94133),p=n(64177),f=n(41435),v=n(72677),h=n(46932),x=n(1324),C=n(39368),g=(0,x.q)({url:function(e){var t=e.postId;return"magnet/posts/".concat(t,"/comments/")},transformer:function(e){var t,n=e.data||{},o=n.comments,r=n.pager;return{comments:(null==o?void 0:null===(t=o.map)||void 0===t?void 0:t.call(o,function(e){return(0,C.T)({data:e})}))||[],pager:(0,h.d)({data:r})}}}),k=n(47842),_=n(98780),j=n(31909),N=n(90877),y=n(26442),b=n(11559),I=n(27314),L=n(52216),P=n(71390),S=n(51383),Z=n(45227),w=(0,x.q)({url:function(e){var t=e.commentId;return"magnet/comments/".concat(t,"/like/")},transformer:function(e){var t=e.data||{};return{isLiked:t.liked,likesCount:t.likes_count}},type:Z.XN.POST}),M=n(9511),T=n.n(M);function U(e){var t=e.comment,n=e.isSecondLevel,o=void 0!==n&&n,r=e.className,s=t||{},u=s.commentId,d=s.commentBody,l=s.commentAuthor,m=s.commentCreatedAt,p=s.commentLikesCount,f=s.commentUserReaction,h=l||{},x=h.authorPhoto,C=h.authorUsername,g=null==f?void 0:f.isLiked,Z=(0,I.e)().redirect,M=(0,a.Z)((0,c.useState)(g),2),U=M[0],E=M[1];(0,c.useEffect)(function(){E(g)},[g]);var R=(0,a.Z)((0,c.useState)(p||0),2),O=R[0],B=R[1];(0,c.useEffect)(function(){B(p)},[p]);var D=(0,b.E)({apiMethod:w}).request,A=function(){Z({url:(0,y.kK)(C)})},z=(0,v.d)((0,k.Z)({"border-complete-r mr-3 pr-4":o},T().secondLevelComment,o),"p-2",r);return(0,i.jsxs)("div",{className:z,children:[(0,i.jsx)("div",{className:(0,v.d)("text-body-2",T().magnetCommentBody),children:d}),(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(j.E,{image:x,height:20,width:20,rounded:32,onClick:A,className:"cursor-pointer",src:P.C}),(0,i.jsx)("span",{className:"text-caption text-neutral-400 mr-2 cursor-pointer",onClick:A,children:C}),(0,i.jsx)(N.g,{className:"mx-2",size:"medium"}),(0,i.jsx)("span",{className:"text-caption mr-1 text-neutral-400",children:(0,L.U)(m)})]}),(0,i.jsx)("div",{children:(0,i.jsx)(S.P,{children:(0,i.jsxs)("span",{className:"cursor-pointer p-2 flex items-center text-button-1 text-neutral-400 user-select-none",onClick:function(){B(function(e){return e+(+!U||-1)}),E(function(e){return!e}),D({commentId:u}).catch(function(){E(function(e){return!e})})},children:[(0,L.U)(O),(0,i.jsx)(_.J,{className:"mr-1",color:U?"primary":"low-emphasis",size:15,icon:U?"favoriteOn":"favoriteOff"})]})})})]})]})}var E=n(59437),R=n(8398),O=(0,x.q)({url:function(e){var t=e.commentId;return"magnet/comments/".concat(t,"/replies/")},inputTransformer:R.d,transformer:function(e){var t=e.data||{},n=t.comments,o=t.pager;return{replies:n.map(function(e){return(0,C.T)({data:e})}),pager:(0,h.d)({data:o})}}});function B(e){var t=e.replies,n=e.repliesCount,u=e.commentId,d=(0,a.Z)((0,c.useState)(!1),2),l=d[0],p=d[1],v=(0,m.a)({apiMethod:O,apiData:{commentId:u},disabled:!u||!l}),h=v.items,x=v.fetchNextPage,C=v.hasNextPage,g=(0,c.useMemo)(function(){return Object.entries(h||{}).filter(function(e){var t=(0,a.Z)(e,2)[1];return!(0,f.x)(t)}).flatMap(function(e){var t=(0,a.Z)(e,2);return(t[0],t[1]).replies}).map(function(e,t){return(0,r.Z)((0,o.Z)({},e),{itemIndex:t})})},[h]);return(0,i.jsxs)("div",{children:[(0,s.Z)(t).concat((0,s.Z)(g)).map(function(e){return(0,i.jsx)(U,{comment:e,isSecondLevel:!0})}),n>(null==g?void 0:g.length)||C&&(0,i.jsx)(E.e,{mode:"anchor",label:"مشاهده بیشتر",onClick:function(){l||p(!0),x()}})]})}function D(e){var t=e.postId,n=e.disabled,h=e.shouldDisplayLoading,x=e.loadingClassName,C=e.emptyStateElement,k=e.userSentComments,_=void 0===k?[]:k,j=(0,m.a)({apiMethod:g,apiData:{postId:t},disabled:!t||void 0!==n&&n}),N=j.data,y=j.items,b=j.fetchPage,I=j.pending,L=j.resetPage,P=(0,p.C)().isDesktop,S=(N||{}).pager,Z=(0,u.useRouter)();(0,c.useEffect)(function(){L(1)},[Z.asPath]);var w=(0,c.useMemo)(function(){return(0,s.Z)(_).concat((0,s.Z)(Object.entries(y||{}).filter(function(e){var t=(0,a.Z)(e,2)[1];return!(0,f.x)(t)}).flatMap(function(e){var t=(0,a.Z)(e,2);return(t[0],t[1]).comments}).map(function(e,t){return(0,r.Z)((0,o.Z)({},e),{itemIndex:t})})))},[y,_]),M=(0,v.d)({"border-complete-b pb-4":!P}),T=(0,c.useCallback)(function(e){var t=e||{},n=t.commentTopReplies,o=t.commentRepliesCount,r=t.commentId;return(0,f.x)(n)?(0,i.jsx)(U,{comment:e,className:M}):(0,i.jsxs)("div",{className:M,children:[(0,i.jsx)(U,{comment:e}),(0,i.jsx)(B,{replies:n,repliesCount:o,commentId:r})]})},[]);return h&&(0,f.x)(w)&&I?(0,i.jsx)(l.g,{className:x}):(0,f.x)(w)?void 0===C?null:C:(0,i.jsx)("div",{className:"flex-1 pb-1",children:(0,i.jsx)(d.S,{itemComponent:T,pager:S,hidePagination:!0,items:w,itemsPerRow:1,itemHasBorder:!1,fetchPage:b})})}},5046:function(e,t,n){"use strict";n.d(t,{l:function(){return m}});var o=n(66383),r=n(52322),a=n(2784),s=n(61538),i=n(59437),c=n(72677),u=n(88342),d=n(12054),l=n.n(d);function m(e){var t=e.post,n=e.titleColor,d=e.captionColor,m=void 0===d?"text-neutral-700":d,p=e.shouldDisplayShowMore,f=void 0===p||p,v=e.className,h=(0,s.d)(),x=h.isOpen,C=h.onToggle,g=t||{},k=g.postTitle,_=g.postCaption,j=(0,a.useRef)(null),N=(0,u.o)({textRef:j,updateDependencies:[_]}).lineCount,y=(0,o.Z)((0,a.useState)(!1),2),b=y[0],I=y[1];return(0,a.useEffect)(function(){I(N>2)},[N]),(0,r.jsxs)("div",{className:(0,c.d)(v,"relative"),children:[(0,r.jsx)("h5",{className:(0,c.d)("text-h5",n),children:k}),(0,r.jsx)("div",{className:(0,c.d)("text-body-1 mb-1",m,{"ellipsis-2":!x}),onClick:function(){f||C()},children:_}),(0,r.jsx)("p",{ref:j,className:(0,c.d)("text-body-1 mb-1 absolute w-full",m,l().shadowPostCaption),children:_}),f&&b&&(0,r.jsxs)(i.e,{mode:"anchor",className:"text-button-2",onClick:C,children:["مشاهده ",x?"کمتر":"بیشتر"]})]})}},96879:function(e,t,n){"use strict";n.d(t,{I:function(){return a}});var o=n(52322),r=n(52216);function a(e){var t=e.value,n=e.valueClassName,a=e.unitClassName,s=t>1e3,i=s?(t/1e3).toFixed(1):t;return(0,o.jsxs)("div",{children:[(0,o.jsx)("span",{className:void 0===n?"text-body1-strong":n,children:(0,r.U)(i)}),s&&(0,o.jsx)("span",{className:void 0===a?"text-body-1 mx-1":a,children:"هزار"})]})}},88342:function(e,t,n){"use strict";n.d(t,{o:function(){return s}});var o=n(66383),r=n(50930),a=n(2784);function s(e){var t=e.textRef,n=e.updateDependencies,s=(0,o.Z)((0,a.useState)(0),2),i=s[0],c=s[1];return(0,a.useLayoutEffect)(function(){if(t.current){var e=t.current;c(Math.round(e.offsetHeight/parseFloat(getComputedStyle(e).lineHeight)))}},(0,r.Z)(n)),{lineCount:i}}},84714:function(e,t,n){"use strict";n.d(t,{g:function(){return i}});var o=n(66383),r=n(2784),a=n(11559),s=n(47792);function i(e,t){var n,i=Boolean(null==e?void 0:null===(n=e.postUserReaction)||void 0===n?void 0:n.isLiked),c=(0,o.Z)((0,r.useState)(i),2),u=c[0],d=c[1];(0,r.useEffect)(function(){d(i)},[i]);var l=(0,o.Z)((0,r.useState)((null==e?void 0:e.postLikesCount)||0),2),m=l[0],p=l[1];(0,r.useEffect)(function(){p((null==e?void 0:e.postLikesCount)||0)},[null==e?void 0:e.postLikesCount]);var f=(0,a.E)({apiMethod:s.m,onSuccess:function(e){var n=e.isLiked;return null==t?void 0:t(n)},onError:function(){return d(function(e){return!e})}}).request;return{likesCount:m,isLiked:u,handleLikePost:function(){p(function(e){return e+(+!u||-1)}),d(function(e){return!e}),f({postId:(e||{}).postId})}}}},98876:function(e,t,n){"use strict";n.d(t,{U:function(){return r}});var o=n(70582);function r(e){var t=e.data||{},n=t.id,r=t.username,a=t.photo,s=t.is_following,i=t.marketplace_seller_id;return{authorId:n,authorUsername:r,authorPhoto:(0,o.W)({data:a}),authorIsFollowing:s,authorMarketplaceSellerId:i}}},39368:function(e,t,n){"use strict";n.d(t,{T:function(){return function e(t){var n=t.data||{},a=n.id,s=n.comment,i=n.author,c=n.likes_count,u=n.created_at,d=n.replies_count,l=n.is_user_own_comment,m=n.user_reaction,p=n.post,f=n.top_replies;return{commentId:a,commentBody:s,commentAuthor:(0,o.U)({data:i}),commentLikesCount:c,commentCreatedAt:u,commentRepliesCount:d,commentIsUserOwnComment:l,commentUserReaction:{isLiked:!!(m||{}).liked},commentPost:(0,r.E)({data:p}),commentTopReplies:null==f?void 0:f.map(function(t){return e({data:t})})}}}});var o=n(98876),r=n(63934)},63934:function(e,t,n){"use strict";n.d(t,{E:function(){return p}});var o=n(70865),r=n(96670),a=n(70582),s=n(76814),i=n(73587),c=n(62114),u=n(98876),d=n(79968),l=n(5525),m=n(96207);function p(e){var t,n,p,f=e.data||{},v=f.id,h=f.title,x=f.caption,C=f.author,g=f.media,k=f.products,_=f.share_urls,j=f.likes_count,N=f.comments_count,y=f.created_at,b=f.tags,I=f.is_user_own_post,L=f.user_reaction,P=f.likes,S=f.circle_cover;return{postId:v,postTitle:h,postCaption:x,postAuthor:(0,u.U)({data:C}),postProducts:null==k?void 0:k.map(function(e){var t;return t=(0,i.r)({data:e}),(0,r.Z)((0,o.Z)({},t),{productPrice:(0,s.z)({data:e.price})})}),postShareUrls:(0,c.r)({data:_}),postLikesCount:j,postMedia:null==g?void 0:g.map(function(e){var t,n,o,r,s,i,c;return n=(t=e||{}).id,o=t.type,r=t.url,s=t.ratio,i=t.cover_small,c=t.cover_big,{postMediaId:n,postMediaType:o,postMediaUrl:(0,d.f)({data:r}),postMediaRatio:s,postMediaSmallCover:(0,a.W)({data:i}),postMediaBigCover:(0,a.W)({data:c})}}),postCommentsCount:N,postCreatedAt:y,postTags:null==b?void 0:b.map(function(e){return(0,l.p)({data:e})}),postIsUserOwnPost:I,postUserReaction:(n=(t=L||{}).liked,p=t.saved,{isLiked:Boolean(n),isSaved:Boolean(p)}),postLikes:null==P?void 0:P.map(function(e){return(0,m.s)({data:e})}),postCircleCover:(0,a.W)({data:S})}}},57033:function(e,t,n){"use strict";n.d(t,{S:function(){return u}});var o=n(70865),r=n(96670),a=n(26297),s=n(52322),i=n(98017),c=n(93008);function u(e){var t=e.lazyLoadOffsetPage,n=void 0===t?c.yo:t,u=(0,a.Z)(e,["lazyLoadOffsetPage"]);return(0,s.jsx)(i.S,(0,r.Z)((0,o.Z)({},u),{lazyLoadOffsetPage:n}))}},90877:function(e,t,n){"use strict";n.d(t,{g:function(){return o.gx}});var o=n(16215)},46932:function(e,t,n){"use strict";function o(e){var t=e.data||{};return{pagerTotalItems:t.total_items,pagerTotalPages:t.total_pages,pagerCurrentPage:t.current_page}}n.d(t,{d:function(){return o}})},9511:function(e){e.exports={magnetCommentBody:"styles_magnetCommentBody__201eS",secondLevelComment:"styles_secondLevelComment__7WAXT"}},12054:function(e){e.exports={shadowPostCaption:"styles_shadowPostCaption__S8Xv_"}}}]);